import{d as v,a as p,b as h}from"./index.a574533b.js";const D=/^rgb(a)?\((\d{1,3}),(\d{1,3}),(\d{1,3}),?([01]?\.?\d*?)?\)$/;function m({r:e,g:t,b:a,a:s}){const r=s!==void 0;if(e=Math.round(e),t=Math.round(t),a=Math.round(a),e>255||t>255||a>255||r&&s>100)throw new TypeError("Expected 3 numbers below 256 (and optionally one below 100)");return s=r?(Math.round(255*s/100)|1<<8).toString(16).slice(1):"","#"+(a|t<<8|e<<16|1<<24).toString(16).slice(1)+s}function w(e){if(typeof e!="string")throw new TypeError("Expected a string");e=e.replace(/^#/,""),e.length===3?e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]:e.length===4&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);const t=parseInt(e,16);return e.length>6?{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:Math.round((t&255)/2.55)}:{r:t>>16,g:t>>8&255,b:t&255}}function k({h:e,s:t,v:a,a:s}){let r,o,n;t=t/100,a=a/100,e=e/360;const c=Math.floor(e*6),u=e*6-c,i=a*(1-t),l=a*(1-u*t),d=a*(1-(1-u)*t);switch(c%6){case 0:r=a,o=d,n=i;break;case 1:r=l,o=a,n=i;break;case 2:r=i,o=a,n=d;break;case 3:r=i,o=l,n=a;break;case 4:r=d,o=i,n=a;break;case 5:r=a,o=i,n=l;break}return{r:Math.round(r*255),g:Math.round(o*255),b:Math.round(n*255),a:s}}function O({r:e,g:t,b:a,a:s}){const r=Math.max(e,t,a),o=Math.min(e,t,a),n=r-o,c=r===0?0:n/r,u=r/255;let i;switch(r){case o:i=0;break;case e:i=t-a+n*(t<a?6:0),i/=6*n;break;case t:i=a-e+n*2,i/=6*n;break;case a:i=e-t+n*4,i/=6*n;break}return{h:Math.round(i*360),s:Math.round(c*100),v:Math.round(u*100),a:s}}function f(e){if(typeof e!="string")throw new TypeError("Expected a string");const t=e.replace(/ /g,""),a=D.exec(t);if(a===null)return w(t);const s={r:Math.min(255,parseInt(a[2],10)),g:Math.min(255,parseInt(a[3],10)),b:Math.min(255,parseInt(a[4],10))};if(a[1]){const r=parseFloat(a[5]);s.a=Math.min(1,isNaN(r)===!0?1:r)*100}return s}function S(e,t){if(typeof e!="string")throw new TypeError("Expected a string as color");if(typeof t!="number")throw new TypeError("Expected a numeric percent");const a=f(e),s=t<0?0:255,r=Math.abs(t)/100,o=a.r,n=a.g,c=a.b;return"#"+(16777216+(Math.round((s-o)*r)+o)*65536+(Math.round((s-n)*r)+n)*256+(Math.round((s-c)*r)+c)).toString(16).slice(1)}function T(e){if(typeof e!="string"&&(!e||e.r===void 0))throw new TypeError("Expected a string or a {r, g, b} object as color");const t=typeof e=="string"?f(e):e,a=t.r/255,s=t.g/255,r=t.b/255,o=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),n=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4),c=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4);return .2126*o+.7152*n+.0722*c}function N(e){if(typeof e!="string"&&(!e||e.r===void 0))throw new TypeError("Expected a string or a {r, g, b} object as color");const t=typeof e=="string"?f(e):e;return(t.r*299+t.g*587+t.b*114)/1e3}function _(e,t){if(typeof e!="string"&&(!e||e.r===void 0))throw new TypeError("Expected a string or a {r, g, b[, a]} object as fgColor");if(typeof t!="string"&&(!t||t.r===void 0))throw new TypeError("Expected a string or a {r, g, b[, a]} object as bgColor");const a=typeof e=="string"?f(e):e,s=a.r/255,r=a.g/255,o=a.b/255,n=a.a!==void 0?a.a/100:1,c=typeof t=="string"?f(t):t,u=c.r/255,i=c.g/255,l=c.b/255,d=c.a!==void 0?c.a/100:1,g=n+d*(1-n),b=Math.round((s*n+u*d*(1-n))/g*255),E=Math.round((r*n+i*d*(1-n))/g*255),M=Math.round((o*n+l*d*(1-n))/g*255),y={r:b,g:E,b:M,a:Math.round(g*100)};return typeof e=="string"?m(y):y}function $(e,t){if(typeof e!="string")throw new TypeError("Expected a string as color");if(t===void 0||t<-1||t>1)throw new TypeError("Expected offset to be between -1 and 1");const{r:a,g:s,b:r,a:o}=f(e),n=o!==void 0?o/100:0;return m({r:a,g:s,b:r,a:Math.round(Math.min(1,Math.max(0,n+t))*100)})}function P(e){if(typeof e!="string")throw new TypeError("Expected a string as color");const t=document.createElement("div");t.className=`text-${e} invisible fixed no-pointer-events`,document.body.appendChild(t);const a=getComputedStyle(t).getPropertyValue("color");return t.remove(),m(f(a))}var J={rgbToHex:m,hexToRgb:w,hsvToRgb:k,rgbToHsv:O,textToRgb:f,lighten:S,luminosity:T,brightness:N,blend:_,changeAlpha:$,getPaletteColor:P};const H=v("data",{state:()=>({devices:[],deviceData:[],types:[],fields:[],include_battery:!1}),actions:{async getFields(){let e=new Date;e.setMinutes(e.getMinutes()-60),this.devices=[];let t={startTime:e};const a=p();await h.get(`/communities/${a.community}/households/${a.household}/fields`,{params:t}).then(s=>{this.fields=s.data})},getTypesOfDevice(e){let t=new Date;t.setMinutes(t.getMinutes()-60),this.devices=[];let a={startTime:t};const s=p();return h.get(`/communities/${s.community}/households/${s.household}/devices/${e}/types`,{params:a})},async getDevices(){let e=new Date;e.setMinutes(e.getMinutes()-60),this.devices=[];let t={startTime:e};const a=p(),s=await h.get(`/communities/${a.community}/households/${a.household}/devices`,{params:t});this.devices=s.data},async getTypes(){let e=new Date;e.setMinutes(e.getMinutes()-60),this.devices=[];let t={startTime:e};const a=p();await h.get(`/communities/${a.community}/households/${a.household}/types`,{params:t}).then(s=>{this.types=s.data})},timeDiff(e){var t=new Date,a=t-new Date(e),s=Math.floor(a/864e5),r=Math.floor(a%864e5/36e5),o=Math.round(a%864e5%36e5/6e4);if(s>0)return`${s} dagen, ${r} uur en ${o} minuten`;if(r>0)return`${r} uur en ${o} minuten`},calculateEndDay(e,t){switch(t){case"H":e.setHours(23,59,59,999);break;case"D":var a=e.getDay(),s=e.getDate()-a+(a==0?-6:1);e.setDate(s+7),e.setHours(0,0,0,0);break;case"W":e.setDate(31),e.setHours(23,59,59,999);break;case"M":e.setFullYear(e.getFullYear()+1),e.setMonth(0),e.setDate(1),e.setHours(0,0,0,0);break}return new Date(e)},calculateStartDay(e,t){switch(t){case"H":e.setHours(0,0,0,0);break;case"D":let a=e.getDay(),s=e.getDate()-a+(a==0?-6:1);e.setDate(s),e.setHours(0,0,0,0);break;case"W":e.setDate(1),e.setHours(0);break;case"M":e.setMonth(0),e.setDate(0),e.setHours(0,0,0,0);break}return new Date(e)},combineArrays(...e){return e.filter(Array.isArray).reduce((t,a)=>[...t,...a],[])},combineWithForecast(e,t){if(e&&t){let a=JSON.parse(JSON.stringify(e)),s=JSON.parse(JSON.stringify(t));return e.forEach((r,o)=>{r.records.forEach((n,c)=>{var i;let u=(i=s[o])==null?void 0:i.records[c];n.value===null&&u&&u.value!==null&&(a[o].records[c]=u)})}),a}return e},async getDeviceName(e){const t=new Date,a=new Date("2023-01-11"),s=p();let r={startTime:a,endTime:t},o=await h.get(`/communities/${s.community}/households/${s.household}/devices/${e}/name`,{params:r});return o.data&&o.data.length>0&&o.data[o.data.length-1].hasOwnProperty("records")?o.data[o.data.length-1].records[o.data[o.data.length-1].records.length-1].value:null},async getDeviceData(e,t,a,s,r=null){const o=p();r===null&&(r=o.household);const n=this.calculateEndDay(new Date(JSON.parse(JSON.stringify(a.endTime))),t);let u={startTime:this.calculateStartDay(new Date(JSON.parse(JSON.stringify(a.endTime))),t),endTime:n},i=await h.post(`/communities/${o.community}/households/${r}/devices/${s}`,e,{params:u}),l=JSON.parse(JSON.stringify(i.data.fluxTables));return this.transformData(l),this.setMetaData(l),l},async getData(e,t,a,s=null){const r=p();s===null&&(s=r.household);const o=this.calculateEndDay(new Date(JSON.parse(JSON.stringify(a.endTime))),t);let c={startTime:this.calculateStartDay(new Date(JSON.parse(JSON.stringify(a.endTime))),t),endTime:o},i=(await h.post(`/communities/${r.community}/households/${s}`,e,{params:c})).data.fluxTables;return this.transformData(i),this.setMetaData(i),i},async getLast(e,t=null){const a=p();t===null&&(t=a.household);let r=(await h.post(`/communities/${a.community}/households/${t}/last`,e)).data.fluxTables;this.transformData(r),this.setMetaData(r);let o=[];return r.length===0?o.push({last:null}):r.forEach(n=>{let c={...n,last:n.records[n.records.length-1].value};o.push(c)}),o},transformData(e){return e.forEach(t=>{let a=t.records[0].values.CTYPEC,s=t.records[0].field;if(["ENE","POW","CO2","CO2_IMP","ENE_IMP","CO2_EXP","ENE_EXP"].includes(s))switch(a){case"generation":t.records=t.records.map(r=>({...r,value:r.value===null?null:r.value>null?0:-r.value}));break;case"supply":(s==="ENE_IMP"||s==="CO2_IMP")&&(t.records=t.records.map(r=>({...r,value:r.value===null?null:r.value}))),(s==="ENE_EXP"||s==="CO2_EXP")&&(t.records=t.records.map(r=>({...r,value:r.value===null?null:-r.value})));break;case"consumption":t.records=t.records.map(r=>({...r,value:r.value<0?0:r.value}));break}}),e},setMetaData(e){const{getPaletteColor:t}=J;return e.forEach(a=>{let s=a.records[0].values.CTYPEC,r=a.records[0].field,o=a.records[0].values.ETYPE,n=t("positive"),c="kWh",u="Wh",i="",l=0;switch(r){case"CO2EQ":i="CO2EQ",c="kg/kWh",u="gram/wh",n=t("blue"),l=1;break;case"CO2_EXP":case"CO2_IMP":case"CO2":i="CO2",c="kg",u="gram",n=t("positive"),l=1;break}switch(s){case"generation":i="Opgewekt",n=t("positive"),l=1;break;case"supply":i="Net",n=t("blue-10"),r==="ENE_IMP"||r==="CO2_IMP"?(n=t("blue-10"),i="Afname Net"):(r==="ENE_EXP"||r==="CO2_EXP")&&(n=t("yellow-10"),i="Teruggeleverd net"),l=3;break;case"consumption":i="Verbruikt",n=t("negative"),l=2;break;case"storage":i="Opslag";break}a.order=l,a.background=n,a.ctypec=s,a.ETYPE=o,a.label=i,a.prefix=c,a.field=r,a.small_prefix=u}),e},getIcon(e){let t="bolt";switch(e){case"powermeter":t="power";break;case"battery":t="battery_full";break;case"solarpannel":t="solar_power";break;case"solarpanel":t="solar_power";break;case"sensor_enviromental":t="sensors";break;case"boiler":t="whatshot";break;case"co2equivalent":t="co2";break;case"dishwasher":t="water_drop";break;case"washingmachine":t="local_laundry_service";break}return t}}});export{J as c,H as u};
