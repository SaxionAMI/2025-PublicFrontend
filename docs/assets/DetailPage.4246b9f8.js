import{Q as N}from"./QCardSection.f5cd6c02.js";import{Q as I,b as Y}from"./QCard.d7854fa9.js";import{Q as $}from"./QPullToRefresh.abd6b150.js";import{_ as W,D as J,aQ as j,r as s,a as z,c as V,F as r,G as K,H as X,I as d,J as i,af as o,ag as D}from"./index.f5aca1b3.js";import{G as Z,S as x,a as ee}from"./GraphDialog.43b34b0e.js";import{a as te,D as ae,U as se,G as oe}from"./GraphTypeTabs.e91e19a3.js";import{u as le}from"./dataStore.9272c3df.js";import{u as ne}from"./use-quasar.cd637f13.js";import"./format.2e053235.js";import"./use-timeout.e6259217.js";import"./QDialog.6da79647.js";import"./use-form.6692f290.js";const ie=J({name:"DetailPage",components:{GraphItem:Z,StatisticsCards:x,DateControls:te,DateTabs:ae,UnitTypeTabs:se,GraphTypeTabs:oe,GraphDialog:ee},setup(){ne();const e=j(),a=s(!1),u=le(),c=z(),E=e.params.device_name.split("&")[0],S=e.params.device_name.split("&")[1].split(",")[0],C=e.params.device_name.split("&")[2],y=s(!1),p=s(null),m=s(new Date(new Date().setHours(23,59,59,999))),h=s(null),g=s(null),b=s(null),l=s(null),T=s(!1),G=()=>{T.value=!0},k=s(!0),q=s("?"),B=s([]),A=t=>{p.value&&p.value.changeStatusChart(t)},n=V({get(){return c.pref_sort},set(t){m.value=new Date(new Date().setHours(23,59,59,999)),c.pref_sort=t,v()}}),f=V({get(){return c.pref_unit},set(t){c.pref_unit=t,v()}}),L=()=>({"tagRestrictions.ctype":["electricity"],createEmpty:!0,dropColumns:["GNAME","ESTYPE","EONNAME"],field:f.value==="kwh"?"ENE":"CO2",windowUnit:n.value==="H"?"m":n.value==="D"?"H":n.value==="M"?"D":n.value}),M=()=>({"tagRestrictions.ctype":["electricity"],createEmpty:!0,dropColumns:["GNAME","ESTYPE","EONNAME"],field:f.value==="kwh"?"forecast.ENE":"forecast.CO2",windowUnit:n.value==="H"?"m":n.value==="D"?"H":n.value==="M"?"D":n.value}),R=()=>({"tagRestrictions.ctype":["electricity"],createEmpty:!0,dropColumns:["GNAME","ESTYPE","EONNAME"],field:f.value==="kwh"?"ENE":"CO2",windowUnit:n.value}),P=()=>({"tagRestrictions.ctype":["electricity"],createEmpty:!0,dropColumns:["GNAME","ESTYPE","EONNAME"],field:f.value==="kwh"?"forecast.ENE":"forecast.CO2",windowUnit:n.value}),w=async(t,O)=>{const H={endTime:m.value};let U=await u.getDeviceData(t,n.value,H,E);return O.value=U,U},v=()=>{let t=[];a.value=!0,t.push(w(L(),g)),t.push(w(R(),h)),t.push(w(M(),l)),t.push(w(P(),b)),Promise.all(t).finally(()=>{a.value=!1})},Q=V(()=>y.value?u.combineWithForecast(g.value,l.value):u.combineWithForecast(h.value,b.value));v();const F=t=>{v(),t()},_=s(null);return{device_name:E,updateData:()=>{_.value&&clearTimeout(_.value),_.value=setTimeout(()=>{v(),_.value=null},333)},dataBar:h,dataLine:g,loading:a,dataStore:u,tab:n,type_device:B,unit:f,type:S,prefix:q,endTime:m,showDialog:G,name:C,showGraphDialog:T,childRef:p,graphData:Q,toggle:y,updateChart:A,refresh:F,showStatistics:k}}}),re={class:"text-h4 text-weight-bold"},de={id:"controls"},ue={class:"row q-ma-sm"},ce={class:"col-6"},pe={class:"col-6"},me=o("div",{id:"reserve_space_footer",style:{height:"5px"}},null,-1),he=o("div",{class:"text-h5 text-weight-bold q-mt-sm"},"Eigenschappen",-1),ge=o("div",{class:"text-weight-bold",style:{display:"inline-block"}},"Naam",-1),fe={style:{display:"inline-block"},class:"q-ml-sm"},ve=o("div",{class:"text-weight-bold",style:{display:"inline-block"}},"Id",-1),ye={style:{display:"inline-block"},class:"q-ml-sm"},be=o("div",{class:"text-weight-bold",style:{display:"inline-block"}},"Type",-1),we={style:{display:"inline-block"},class:"q-ml-sm"};function _e(e,a,u,c,E,S){const C=r("statistics-cards"),y=r("date-tabs"),p=r("date-controls"),m=r("graph-item"),h=r("unit-type-tabs"),g=r("graph-type-tabs"),b=r("graph-dialog");return K(),X($,{onRefresh:e.refresh,color:"accent"},{default:d(()=>[i(Y,{class:"q-mx-md q-mt-sm",style:{display:"flex","flex-flow":"column",height:"100% !important"}},{default:d(()=>[o("span",re,D(e.name),1),o("div",de,[i(C,{id:"statistics-cards",data:e.dataLine,loading:e.loading,tab:e.tab,showAverage:!1,showString:!0,onUpdateChart:e.updateChart,class:"q-my-sm"},null,8,["data","loading","tab","onUpdateChart"]),i(y,{id:"date-tabs",class:"q-mt-md",modelValue:e.tab,"onUpdate:modelValue":a[0]||(a[0]=l=>e.tab=l)},null,8,["modelValue"]),i(p,{class:"q-my-sm",style:{width:"100%"},id:"date-controls",modelValue:e.endTime,"onUpdate:modelValue":[a[1]||(a[1]=l=>e.endTime=l),e.updateData],tab:e.tab},null,8,["modelValue","tab","onUpdate:modelValue"])]),i(m,{id:"graph",data:e.graphData,style:{"flex-grow":"1","min-height":"35vh"},class:"q-pb-sm",isLineChart:e.toggle,showFullscreen:!0,loading:e.loading,excludeDataset:["supply"],tab:e.tab,showLegend:!1,onShowDialog:e.showDialog,ref:"childRef"},null,8,["data","isLineChart","loading","tab","onShowDialog"]),o("div",ue,[o("div",ce,[i(h,{modelValue:e.unit,"onUpdate:modelValue":a[2]||(a[2]=l=>e.unit=l)},null,8,["modelValue"])]),o("div",pe,[i(g,{class:"float-right",modelValue:e.toggle,"onUpdate:modelValue":a[3]||(a[3]=l=>e.toggle=l)},null,8,["modelValue"])])]),me,he,i(I,{class:"card q-mt-md",id:"properties"},{default:d(()=>[i(N,null,{default:d(()=>[ge,o("div",fe,D(e.name),1)]),_:1}),i(N,null,{default:d(()=>[ve,o("div",ye,D(e.device_name),1)]),_:1}),i(N,null,{default:d(()=>[be,o("div",we,D(e.type),1)]),_:1})]),_:1}),i(b,{id:"graph-dialog",isLineChart:e.toggle,modelValue:e.showGraphDialog,"onUpdate:modelValue":a[4]||(a[4]=l=>e.showGraphDialog=l),data:e.toggle?e.dataLine:e.dataBar,tab:e.tab},null,8,["isLineChart","modelValue","data","tab"])]),_:1})]),_:1},8,["onRefresh"])}var Le=W(ie,[["render",_e]]);export{Le as default};
